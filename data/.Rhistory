print(x)
}
x=4/3
for i in (1:3){
x=x-(7*x^6-6)/(42*x^5)
print(x)
}
x=4/3
for i in c(1:3){
x=x-(7*x^6-6)/(42*x^5)
print(x)
}
x=4/3
for i in (1:3){
print(x)
}
x=4/3
for (i in 1:3){
x=x-(7*x^6-6)/(42*x^5)
print(x)
}
x=4/3
for (i in 1:10){
x=x-(7*x^6-6)/(42*x^5)
print(x)
}
x=4/3
for (i in 1:10){
x=x-(x^7-6x+4)/(7*x^6-6)
print(x)
}
x=4/3
for (i in 1:10){
x=x-(x^7-6x+4)/(7*x^6-6)
print(x)
}
for (i in 1:10){
x=x-(x^7-6*x+4)/(7*x^6-6)
print(x)
}
x=4/3
for (i in 1:10){
x=x-(x^7-6*x+4)/(7*x^6-6)
print(x)
}
x=2/3
for (i in 1:10){
x=x-(x^7-6*x+4)/(7*x^6-6)
print(x)
}
read.table(file = '/Users/chen.liang/Downloads/etymwn-20130208/etymwn.tsv', sep = '\t', header = FALSE)
data<-as.data.frame(fread(address))
require(data.table)
address = '/Users/chen.liang/Downloads/etymwn-20130208/etymwn.tsv'
data<-as.data.frame(fread(address))
View(data)
colnames(data) = c('from', 'r', 'to')
View(data)
net <- graph_from_data_frame(d=data)
library("igraph")
net <- graph_from_data_frame(d=data)
plot(net)
net <- graph_from_data_frame(d=data[1:10000])
net <- graph_from_data_frame(d=data[1:10000,])
plot(net)
l <- layout_with_lgl(net)
plot(net, layout=l, edge.arrow.size=.4, vertex.label=NA, vertex.color=my_color)
net$size = 1
plot(net, layout=l, edge.arrow.size=.4,
vertex.label=NA)
net$size = 0.1
plot(net, layout=l, edge.arrow.size=.4,
vertex.label=NA)
net$size = 0.1
plot(net, layout=l, edge.arrow.size=.4,
vertex.label=NA)
net <- graph_from_data_frame(d=data[1:10000,])
l <- layout_with_lgl(net)
plot(net, layout=l, edge.arrow.size=.4,
vertex.label=NA)
plot(net, edge.arrow.size=.4, vertex.label=NA)
plot(net, edge.arrow.size=.4, vertex.label=NA)
l <- layout_on_grid(net)
plot(net, edge.arrow.size=.4, vertex.label=NA)
x=betweenness(net,normalized = T)
x=data.frame(betweenness(net,normalized = T))
View(x)
x=sort(data.frame(betweenness(net,normalized = T)))
x=data.frame(betweenness(net,normalized = T))
x= sort(x)
x=data.frame(sort(betweenness(net,normalized = T)))
x=data.frame(sort(betweenness(net,normalized = T), decreasing = FALSE))
x=data.frame(rev(betweenness(net,normalized = T)))
x=data.frame(rev(betweenness(net,normalized = T)))
table(x)
library(xlsx)
path = "/Users/chen.liang/Desktop/SPLC/data/All\ Phones.xlsx"
data = read.xlsx(path, "sheet2")
path = "/Users/chen.liang/Desktop/SPLC/data/All\ Phones.xlsx"
data = read.xlsx(path, "samsung")
View(data)
huawei = read.xlsx(path, "KMCACZ CH Equity")
data = rbind(samsung,xiaomi, apple, huawei)
samsung = read.xlsx(path, "samsung")
xiaomi = read.xlsx(path, "xiaomi")
apple = read.xlsx(path, "AAPL")
data = rbind(samsung,xiaomi, apple)
View(data)
all_companies = c(samsung$com, samsung$sup, samsung$cus,
xiaomi$com, xiaomi$sup, xiaomi$cus,
apple$com, apple$sup, apple$cus,)
all_companies = c(samsung$com, samsung$sup, samsung$cus,
xiaomi$com, xiaomi$sup, xiaomi$cus,
apple$com, apple$sup, apple$cus)
data = data %>% mutate_all(as.character)
library(dplyr)
data = data %>% mutate_all(as.character)
View(data)
data = data %>% mutate_at(com, sup, cus, as.character)
data = data %>% mutate_at(vars(com, sup, cus), as.character)
data = rbind(samsung,xiaomi, apple)
data = data %>% mutate_at(vars(com, sup, cus), as.character)
all_companies = c(samsung$com, samsung$sup, samsung$cus,
xiaomi$com, xiaomi$sup, xiaomi$cus,
apple$com, apple$sup, apple$cus)
data = data %>% mutate_all(as.character)
all_companies = c(samsung$com, samsung$sup, samsung$cus,
xiaomi$com, xiaomi$sup, xiaomi$cus,
apple$com, apple$sup, apple$cus)
sumsung$com
samsung$com
data = data %>% mutate_all(as.character)
all_companies = c(samsung$com, samsung$sup, samsung$cus,
xiaomi$com, xiaomi$sup, xiaomi$cus,
apple$com, apple$sup, apple$cus)
samsung$com
all_companies = c(data$com, data$sup, data$cus)
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
access_com_info = data.frame(all_companies_ticker)
View(access_com_info)
access_com_info = data.frame(all_companies_ticker)
all_companies_ticker$Name = NA
all_companies_ticker$country = NA
all_companies_ticker$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i)
all_companies_ticker$Name[i] = gsub("A2",company, get_Name)
all_companies_ticker$country[i] = gsub("A2",company, get_country)
all_companies_ticker$gics[i] = gsub("A2",company, get_gics)
}
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info = data.frame(all_companies_ticker)
all_companies_ticker$Name = NA
all_companies_ticker$country = NA
all_companies_ticker$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i)
all_companies_ticker$Name[i] = gsub("A2",company, get_Name)
all_companies_ticker$country[i] = gsub("A2",company, get_country)
all_companies_ticker$gics[i] = gsub("A2",company, get_gics)
}
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info = data.frame(all_companies_ticker)
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
View(access_com_info)
for(i in 1:nrow(access_com_info)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
setwd("~/Desktop/SPLC/data/190821")
data = read.xlsx("Volkswagen.xlsx", 2)
vk <- read.xlsx("Volkswagen.xlsx", 2)
gm <- read.xlsx("GM.xlsx", 2)
Hy <- read.xlsx("Hyundai.xlsx", 2)
ty <- read.xlsx("Toyota.xlsx", 2)
sa <- read.xlsx("SAIC.xlsx", 2)
data=rbind(vk,gm)
data=rbind(data,Hy)
data=rbind(data,ty)
data=rbind(data,sa)
remove(vk,gm,Hy,ty,sa)
data$com_N=as.character(data$com_N)
data$sup_N=as.character(data$sup_N)
data$cus_N=as.character(data$cus_N)
supply = data[c(2,4,7)]
cus = data[c(6,2,8)]
colnames(supply)=c("to","from","weight")
colnames(cus)=c("to","from","weight")
Edges_Data = rbind(supply, cus)
remove(cus, supply)
supply_n = data[c(4,9,10)]
cus_n = data[c(6,11,12)]
colnames(supply_n)=c("id","country","type_label")
colnames(cus_n)=c("id","country","type_label")
Nodes_Data = rbind(supply_n, cus_n)
remove(supply_n, cus_n)
Nodes_Data$country=as.character(Nodes_Data$country)
Nodes_Data$country[which(Nodes_Data$country=="HK")]="CN"
View(Nodes_Data)
View(Nodes_Data)
Edges_Data=Edges_Data[!is.na(Edges_Data$from) & Edges_Data$from!="" & Edges_Data$from!="#N/A Invalid Security",]
Edges_Data=Edges_Data[!is.na(Edges_Data$to) & Edges_Data$to!="" & Edges_Data$to!="#N/A Invalid Security",]
Edges_Data=Edges_Data[!duplicated(Edges_Data),]
Nodes_Data=Nodes_Data[!is.na(Nodes_Data$id) & Nodes_Data$id!="" & Nodes_Data$id!="#N/A Invalid Security",]
Nodes_Data=Nodes_Data[!duplicated(Nodes_Data),]
View(Nodes_Data)
write.csv(Nodes_Data, "Node_Data")
library(xlsx)
library(dplyr)
path = "/Users/chen.liang/Desktop/SPLC/data/All\ Phones.xlsx"
samsung = read.xlsx(path, "samsung")
xiaomi = read.xlsx(path, "xiaomi")
apple = read.xlsx(path, "AAPL")
huawei = read.xlsx(path, "KMCACZ CH Equity")
data = rbind(samsung,xiaomi, apple)
data = data %>% mutate_at(vars(com, sup, cus), as.character)
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info = data.frame(all_companies_ticker)
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
existing_data = read.csv("~/Desktop/SPLC/data/190821/Node_Data")
View(existing_data)
View(existing_data)
existed_data = read.csv("~/Desktop/SPLC/data/190821/Node_Data")
existed_node = unique(existed_data$id)
setdiff(existed_node, all_companies_ticker)
View(access_com_info)
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
all_companies_ticker = unique(c(data$com, data$sup, data$cus), is.na=F)
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
all_companies_ticker
all_companies_ticker = all_companies_ticker %>% filter(!is.na(all_companies_ticker),
all_companies_ticker!=0,
all_companies_ticker!= "#N/A N/A")
all_companies_ticker = all_companies_ticker %>% filter(na.rm = T
all_companies_ticker!=0,
all_companies_ticker!= "#N/A N/A")
all_companies_ticker = all_companies_ticker %>% filter(na.rm = T &
all_companies_ticker!=0 &
all_companies_ticker!= "#N/A N/A")
all_companies_ticker = all_companies_ticker %>% filter(na.rm = T &
all_companies_ticker!= "0" &
all_companies_ticker!= "#N/A N/A")
access_com_info = access_com_info %>% filter(na.rm = T &
ticker!= "0" &
ticker!= "#N/A N/A")
access_com_info = access_com_info %>% filter(ticker!= NA &
ticker!= "0" &
ticker!= "#N/A N/A")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:nrow(access_com_info)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
data = rbind(samsung,xiaomi, apple)
data = data %>% mutate_at(vars(com, sup, cus), as.character)
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= NA &
ticker!= "0" &
ticker!= "#N/A N/A")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:(nrow(access_com_info)-1)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
data = rbind(samsung,xiaomi, apple)
data = data %>% mutate_at(vars(com, sup, cus), as.character)
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= NA &
ticker!= "0" &
ticker!= "#N/A N/A")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
access_com_info = access_com_info %>% filter(ticker!= NA &
ticker!= "0" &
ticker!= "#N/A N/A")
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= NA &
ticker!= "0" &
ticker!= "#N/A N/A")
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= NA)
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= 0)
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= 0 &
ticker!= "#N/A N/A")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:(nrow(access_com_info)-1)){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
View(access_com_info)
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
access_com_info = data.frame("ticker" = all_companies_ticker)
access_com_info = access_com_info %>% filter(ticker!= 0 &
ticker!= "#N/A N/A")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:(nrow(access_com_info))){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
setwd("~/Desktop/变量/SPLC/data")
data1 = read.xlsx("da_equipment.xlsx", "Sheet7")
data2 = read.xlsx("da_equipment.xlsx", "Sheet8")
data3 = read.xlsx("da_equipment.xlsx", "Sheet9")
data4 = read.xlsx("da_equipment.xlsx", "Sheet10")
data5 = read.xlsx("da_equipment.xlsx", "Sheet11")
data6 = read.xlsx("da_equipment.xlsx", "Sheet12")
data7 = read.xlsx("da_materials.xlsx", "Sheet6")
data8 = read.xlsx("da_materials.xlsx", "Sheet7")
data9 = read.xlsx("da_materials.xlsx", "Sheet8")
data10 = read.xlsx("da_materials.xlsx", "Sheet9")
data11 = read.xlsx("da_materials.xlsx", "Sheet10")
data12 = read.xlsx("da_storage.xlsx", "Sheet1")
data13 = read.xlsx("da_storage.xlsx", "Sheet2")
data14 = read.xlsx("da_storage.xlsx", "Sheet3")
data15 = read.xlsx("da_storage.xlsx", "Sheet4")
data16 = read.xlsx("da_storage.xlsx", "Sheet5")
data17 = read.xlsx("da_yuanqi.xlsx", "Sheet1")
data18 = read.xlsx("da_yuanqi.xlsx", "Sheet2")
data19 = read.xlsx("da_yuanqi.xlsx", "Sheet3")
data20 = read.xlsx("da_yuanqi.xlsx", "Sheet4")
data21 = read.xlsx("da_yuanqi.xlsx", "Sheet5")
data22 = read.xlsx("da_yuanqi.xlsx", "Sheet6")
data23 = read.xlsx("da_yuanqi.xlsx", "Sheet7")
data = rbind(data1, data2, data3, data4, data5, data6,
data7, data8, data9, data10, data11, data12,
data13, data14, data15, data16, data17, data18,
data19, data20, data21, data22, data23)
View(data)
Nodes_Data=data[!is.na(data$id) & data$id!="" & data$id!="#N/A Invalid Security",]
Nodes_Data=Nodes_Data[!duplicated(Nodes_Data),]
View(Nodes_Data)
library(dplyr)
data = rbind(data1, data2, data3, data4, data5, data6,
data7, data8, data9, data10, data11, data12,
data13, data14, data15, data16, data17, data18,
data19, data20, data21, data22, data23)
data = data %>% mutate_all(as.character)
supply_n = data[c(4,9,10)]
cus_n = data[c(6,11,12)]
colnames(supply_n)=c("id","country","type_label")
colnames(cus_n)=c("id","country","type_label")
Nodes_Data = rbind(supply_n, cus_n)
remove(supply_n, cus_n)
Nodes_Data=data[!is.na(data$id) & data$id!="" & data$id!="#N/A Invalid Security",]
Nodes_Data=Nodes_Data[!duplicated(Nodes_Data),]
supply_n = data[c(4,9,10)]
cus_n = data[c(6,11,12)]
colnames(supply_n)=c("id","country","type_label")
colnames(cus_n)=c("id","country","type_label")
Nodes_Data = rbind(supply_n, cus_n)
Nodes_Data=Nodes_Data[!is.na(Nodes_Data$id) & Nodes_Data$id!="" & Nodes_Data$id!="#N/A Invalid Security",]
Nodes_Data=Nodes_Data[!duplicated(Nodes_Data),]
remove(data*)
View(Nodes_Data)
supply_n = data[c(3,4,9,10)]
cus_n = data[c(5,6,11,12)]
colnames(supply_n)=c("ticker","id","country","type_label")
colnames(cus_n)=c("ticker","id","country","type_label")
Nodes_Data = rbind(supply_n, cus_n)
remove(supply_n, cus_n)
Nodes_Data=Nodes_Data[!is.na(Nodes_Data$id) & Nodes_Data$id!="" & Nodes_Data$id!="#N/A Invalid Security",]
Nodes_Data=Nodes_Data[!duplicated(Nodes_Data),]
write.csv(Nodes_Data, "Nodes_Data")
write.csv(Nodes_Data, "Data_Dict/Nodes_Data.csv")
write.csv(Nodes_Data, "Data_Dict/Nodes_Data.csv", row.names = F)
path = "/Users/chen.liang/Desktop/SPLC/data/All\ Phones.xlsx"
samsung = read.xlsx(path, "samsung")
xiaomi = read.xlsx(path, "xiaomi")
apple = read.xlsx(path, "AAPL")
huawei = read.xlsx(path, "KMCACZ CH Equity")
data = rbind(samsung,xiaomi, apple)
data = data %>% mutate_at(vars(com, sup, cus), as.character)
all_companies_ticker = unique(c(data$com, data$sup, data$cus))
existing_nodes = read.csv("/Users/chen.liang/Desktop/变量/SPLC/data/Data_Dict/Nodes_Data.csv")
View(existing_nodes)
existing_nodes = existing_nodes$ticker
existing_nodes = as.character(existing_nodes$ticker)
existing_nodes = read.csv("/Users/chen.liang/Desktop/变量/SPLC/data/Data_Dict/Nodes_Data.csv")
existing_nodes = as.character(existing_nodes$ticker)
?setdiff
?setdiff()
a = [1,2,3]
a=c(1,2,3)
b=c(2,3,4)
sefdiff(a,b)
setdiff(a,b)
setdiff(b,a)
new_ticker = setdiff(all_companies_ticker, existing_nodes)
new_ticker
access_com_info = data.frame("ticker" = new_ticker)
access_com_info = access_com_info %>% filter(ticker!= 0 &
ticker!= "#N/A N/A")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:(nrow(access_com_info))){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
View(access_com_info)
View(access_com_info$ticker)
access_com_info$ticker
as.character(access_com_info$ticker)
access_com_info = data.frame("ticker" = new_ticker)
access_com_info = access_com_info %>% filter(ticker!= 0 &
ticker!= "#N/A N/A",
ticker!= "#N/A Invalid Security",
ticker!= "#N/A Requesting Data...")
get_Name="=IF(ISBLANK(A2),\"\",BDP(A2, \"LONG_COMP_NAME\",\"\"))"
get_country="=IF(ISBLANK(A2),\"\",BDP(A2, \"CNTRY_OF_DOMICILE\",\"\"))"
get_gics="=IF(ISBLANK(A2),\"\",BDP(A2, \"GICS_INDUSTRY_GROUP_NAME\",\"\"))"
access_com_info$Name = NA
access_com_info$country = NA
access_com_info$gics = NA
for(i in 1:(nrow(access_com_info))){
company = paste0("A", i+1)
access_com_info$Name[i] = gsub("A2",company, get_Name)
access_com_info$country[i] = gsub("A2",company, get_country)
access_com_info$gics[i] = gsub("A2",company, get_gics)
}
write.csv(access_com_info, "Request/Node_info.csv")
write.csv(access_com_info, "Request/Node_info.csv", row.names = F)
write.xlsx(access_com_info, "Request/Node_info.xlsx")
write.xlsx(access_com_info, "Request/Node_info.xlsx", row.names = F)
